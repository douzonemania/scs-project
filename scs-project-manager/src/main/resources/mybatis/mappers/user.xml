<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user">

	<update id="createTable" parameterType="HashMap">
			${sql}
	</update>
	
	<update id="alterTable" parameterType="HashMap">
			${sql}
	</update>


	<insert id="insert" parameterType="ceovo">
		<![CDATA[
			insert
			  into ceo
			values (#{id}, #{name}, #{password}, #{phoneNumber}, #{email}, #{companyName},
			        now(), #{faxNumber}, #{cpNumber}, #{address}, #{siteName}, #{coNumber}, #{cmNumber})
		]]>
	</insert>

	<select id="findById" parameterType="string" resultType="ceovo">
		<![CDATA[
			select 
				   id,
				   name, 
				   email, 
				   reg_date as regDate, 
		      from ceo 
		     where id = #{id};
			
		]]>
	</select>
	
	<select id="findByIdAndPassword" parameterType="ceovo" resultType="ceovo">
		<![CDATA[
			select 
				   id,
				   name, 
				   password, 
				   phone_number as phoneNumber, 
				   email, 
				   company_name as companyName,
				   reg_date as regDate, 
				   fax_number as faxNumber, 
				   cp_number as cpNumber, 
				   address, 
				   site_name as siteName, 
				   co_number as coNumber, 
				   cm_number as cmNumber 
		      from ceo 
		     where id = #{id}
		       and password = #{password};
		]]>
	</select>
	
	<update id="updateCeo" parameterType="ceovo">
		<choose>
			<when test="shipCharge eq null">
				<![CDATA[
					update ceo c, site s
					   set c.name = #{name },
							c.password = #{password },
						    c.phone_number = #{phoneNumber },
						    c.email = #{email },
						    c.company_name = #{companyName },
						    c.fax_number = #{faxNumber },
						    c.cp_number = #{cpNumber },
						    c.address = #{address },
							c.site_name = #{email },
						    c.co_number = #{coNumber },
						    c.cm_number = #{cmNumber },
						    s.ceo = #{name },
						    s.ship_charge = 0,
						    s.logo = #{logo },
						    s.favicon = #{favicon }
					where c.id=s.id and
						  c.id ='sjy8033';
				]]>
			</when>
			<otherwise>
				<![CDATA[
					update ceo c, site s
					   set c.name = #{name },
							c.password = #{password },
						    c.phone_number = #{phoneNumber },
						    c.email = #{email },
						    c.company_name = #{companyName },
						    c.fax_number = #{faxNumber },
						    c.cp_number = #{cpNumber },
						    c.address = #{address },
							c.site_name = #{email },
						    c.co_number = #{coNumber },
						    c.cm_number = #{cmNumber },
						    s.ceo = #{name },
						    s.ship_charge = #{shipCharge },
						    s.logo = #{logo },
						    s.favicon = #{favicon }
					where c.id=s.id and
						  c.id ='sjy8033';
				]]>
			</otherwise>
		</choose>

	</update>
	
	
</mapper>
