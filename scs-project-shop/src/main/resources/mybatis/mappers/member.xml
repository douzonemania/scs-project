<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="member">
	
	<select id="existUser" resultType="int" parameterType="map" >
		<![CDATA[
			select count(*) 
			from ${db}.member a
			where  a.id like #{id}
		]]>
	</select>
	
	<insert id="insertUser" parameterType="map">
		insert 
			into ${db}.member values(
			null,#{vo.id},#{vo.name},#{vo.password},#{vo.phoneNumber},
			#{vo.email},now(),'회원','일반')
	</insert> 

	<select id="findUser" parameterType = "map" resultType = "int">
				<![CDATA[
				select ifnull(no,0), ifnull(phone_number,0), ifnull(email,0)
				from ${db}.member
				where id like #{vo.id} and password like #{vo.password}
				]]>
	</select>

	<select id="findUserByNo" parameterType = "map" resultType = "membervo">
				<![CDATA[
				select no, id, password, phone_number as 'phoneNumber', email, name
				from ${db}.member
				where no = #{no}
				]]>
	</select>
	
	<select id="find" parameterType = "map" resultType = "itemvo">
				<![CDATA[
				select * 
				from ${id}.item a, ${id}.item b
				
				]]>
	</select>

	<select id="findIdByPhone" parameterType="map" resultType="string">
		<![CDATA[
			select id
			  from ${db}.member
			 where phone_number=#{phoneNum}
		]]>
	</select>
	
	<select id="findEmailById" parameterType="map" resultType="string">
		<![CDATA[
			select email
			  from ${db}.member
			 where id=#{id}
		]]>
	</select>
	
	<update id="updatePassword" parameterType="map">
		<![CDATA[
			update ${db}.member
			   set password=#{password}
			 where id=#{id}
		]]>
	</update>
	
	<update id="modPassword" parameterType="map">
		<![CDATA[
			update ${db}.member
			   set password=#{newPassword}
			 where id=#{id}
		]]>
	</update>
	
	<update id="modName" parameterType="map">
		<![CDATA[
			update ${db}.member
			   set name=#{name}
			 where id=#{id}
		]]>
	</update>
	
	<update id="modPhone" parameterType="map">
		<![CDATA[
			update ${db}.member
			   set phone_number=#{phone}
			 where id=#{id}
		]]>
	</update>
</mapper>